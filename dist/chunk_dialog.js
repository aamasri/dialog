"use strict";(self.webpackChunk_aamasri_dialog=self.webpackChunk_aamasri_dialog||[]).push([[907],{943:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{close:()=>dialog_close,closeAll:()=>closeAll,closeLast:()=>closeLast,open:()=>dialog_open});let loadUrlBusy;const dialog_open=async function(options){if(options=options||{},throttleEvent())return;const dialogId="dialog-"+function(object){const json=JSON.stringify(object);let hash=0;for(let i=0;i<json.length;i++)hash=(hash<<5)-hash+json.charCodeAt(i),hash|=0;false;return hash}(options);if(document.querySelector(`#${dialogId}:not(.closing)`))return void 0;await async function(){void 0===window.jQuery&&(window.jQuery=await __webpack_require__.e(881).then(__webpack_require__.t.bind(__webpack_require__,692,23)),window.jQuery=window.jQuery.default);false;void 0===window.anime&&(window.anime=await __webpack_require__.e(389).then(__webpack_require__.bind(__webpack_require__,776)),window.anime=window.anime.default);false}();const $body=jQuery("body");let dialogBody;options.title||options.source||(options.title="Dialog Cheat Sheet",options.source=usageInstructions);let dialogTitle=options.title||"";const sourceIsUrl="string"==typeof options.source&&(/^https?:\/\/[a-z]+/.test(options.source)||/^\/[a-z]+/.test(options.source));let useIframe=options.iframe&&sourceIsUrl||!1;if(useIframe&&(dialogBody=`<iframe src="${options.source}"></iframe>`),!sourceIsUrl){false;try{const sourceElement=document.querySelector(options.source);false,sourceElement&&(dialogBody=sourceElement.innerHTML,dialogTitle=dialogTitle||sourceElement.title||"")}catch(error){false}dialogBody=dialogBody||options.source||""}options.replace=void 0===options.replace||!!options.replace,options.replace&&closeAll(dialogId);const modalDiv=options.modal?`<div class="dialog-modal" data-for="${dialogId}"></div>`:"",urlData=useIframe||options.fullscreenUrl?`data-url="${options.fullscreenUrl||options.source}"`:"",createdData=`data-created="${Date.now()}"`,fullScreenIcon=useIframe||options.fullscreenUrl?'<span class="icon-fullscreen" title="Fullscreen"><svg xmlns="http://www.w3.org/2000/svg" viewBox="21 21 130 130">\n    <path d="M35.83333,21.5c-7.83362,0 -14.33333,6.49972 -14.33333,14.33333v21.5c-0.03655,2.58456 1.32136,4.98858 3.55376,6.29153c2.2324,1.30295 4.99342,1.30295 7.22582,0c2.2324,-1.30295 3.59031,-3.70697 3.55376,-6.29153v-21.5h21.5c2.58456,0.03655 4.98858,-1.32136 6.29153,-3.55376c1.30295,-2.2324 1.30295,-4.99342 0,-7.22582c-1.30295,-2.2324 -3.70697,-3.59031 -6.29153,-3.55376zM114.66667,21.5c-2.58456,-0.03655 -4.98858,1.32136 -6.29153,3.55376c-1.30295,2.2324 -1.30295,4.99342 0,7.22582c1.30295,2.2324 3.70697,3.59031 6.29153,3.55376h21.5v21.5c-0.03655,2.58456 1.32136,4.98858 3.55376,6.29153c2.2324,1.30295 4.99342,1.30295 7.22582,0c2.2324,-1.30295 3.59031,-3.70697 3.55376,-6.29153v-21.5c0,-7.83362 -6.49972,-14.33333 -14.33333,-14.33333zM28.55469,107.40202c-3.95253,0.06178 -7.10882,3.312 -7.05469,7.26465v21.5c0,7.83362 6.49972,14.33333 14.33333,14.33333h21.5c2.58456,0.03655 4.98858,-1.32136 6.29153,-3.55376c1.30295,-2.2324 1.30295,-4.99342 0,-7.22582c-1.30295,-2.2324 -3.70697,-3.59031 -6.29153,-3.55376h-21.5v-21.5c0.02653,-1.93715 -0.73227,-3.80254 -2.10349,-5.17112c-1.37122,-1.36858 -3.23806,-2.12378 -5.17516,-2.09353zM143.22135,107.40202c-3.95253,0.06178 -7.10882,3.312 -7.05469,7.26465v21.5h-21.5c-2.58456,-0.03655 -4.98858,1.32136 -6.29153,3.55376c-1.30295,2.2324 -1.30295,4.99342 0,7.22582c1.30295,2.2324 3.70697,3.59031 6.29153,3.55376h21.5c7.83362,0 14.33333,-6.49972 14.33333,-14.33333v-21.5c0.02653,-1.93715 -0.73227,-3.80254 -2.10349,-5.17112c-1.37122,-1.36858 -3.23806,-2.12378 -5.17516,-2.09353z"/>\n</svg></span>':"";let classes=[];useIframe&&classes.push("has-iframe"),dialogTitle||classes.push("chromeless"),options.persistent&&classes.push("persistent"),options.classes&&"string"==typeof options.classes&&classes.push(options.classes);const attributes=options.attributes||"";let $dialog=jQuery(`${modalDiv}\n                        <div id="${dialogId}" class="dialog-box loading ${classes.join(" ")}" ${attributes} ${createdData} ${urlData}>\n                            <div class="dialog-header">\n                                <div class="title">${dialogTitle}</div>\n                                <div class="icons">\n                                    ${fullScreenIcon}\n                                    <span class="icon-close"><svg xmlns="http://www.w3.org/2000/svg" viewBox="28 28 116 116">\n     <path d="M35.76335,28.59668c-2.91628,0.00077 -5.54133,1.76841 -6.63871,4.47035c-1.09737,2.70194 -0.44825,5.79937 1.64164,7.83336l45.09961,45.09961l-45.09961,45.09961c-1.8722,1.79752 -2.62637,4.46674 -1.97164,6.97823c0.65473,2.51149 2.61604,4.4728 5.12753,5.12753c2.51149,0.65473 5.18071,-0.09944 6.97823,-1.97165l45.09961,-45.09961l45.09961,45.09961c1.79752,1.87223 4.46675,2.62641 6.97825,1.97168c2.5115,-0.65472 4.47282,-2.61605 5.12755,-5.12755c0.65472,-2.5115 -0.09946,-5.18073 -1.97168,-6.97825l-45.09961,-45.09961l45.09961,-45.09961c2.11962,-2.06035 2.75694,-5.21064 1.60486,-7.93287c-1.15207,-2.72224 -3.85719,-4.45797 -6.81189,-4.37084c-1.86189,0.05548 -3.62905,0.83363 -4.92708,2.1696l-45.09961,45.09961l-45.09961,-45.09961c-1.34928,-1.38698 -3.20203,-2.16948 -5.13704,-2.1696z"/>\n</svg></span>\n                                </div>\n                            </div>\n                            \n                            <div class="dialog-body">\n                                ${dialogBody||'<div class="dialog-loader">Loading <div class="dialog-progress-bar"></div></div>'}\n                            </div>\n                        </div>`);$dialog.appendTo($body);const domUtils=await __webpack_require__.e(885).then(__webpack_require__.bind(__webpack_require__,837));const onTop=domUtils.onTopZIndex();let $modal;onTop&&$dialog.css("z-index",onTop),options.modal&&($modal=$body.find(`data-url[${dialogId}]`),$dialog=$body.find(`#${dialogId}`)),function(){if(blurHandlerBound)return;blurHandlerBound=!0,jQuery(document).on("click",docClickHandler),jQuery(document).on("keydown",docKeyHandler)}(),options.onClose&&function($dialog,callback){const observer=new MutationObserver((mutationsList=>{mutationsList.forEach((mutation=>{mutation.removedNodes.forEach((node=>{$dialog.is(jQuery(node))&&function(callback){switch(typeof callback){case"function":return void callback();case"string":try{!function(code){if("string"!=typeof code)throw new Error("Code must be a string");try{return new Function(`"use strict"; return (${code});`)()}catch(error){return console.error("Error evaluating code:",error),null}}(callback)}catch(error){console.error("close callback failed with",error)}}}(callback)}))}))}));observer.observe(document.querySelector("body"),{childList:!0,subtree:!0})}($dialog,options.onClose);let openAnimation=openAnimateDialog($dialog);if(sourceIsUrl&&!useIframe){if(loadUrlBusy)return console.warn("dialog cancelled because another dialog is loading"),$modal&&$modal.remove(),void $dialog.remove();loadUrlBusy=window.setTimeout((()=>{loadUrlBusy=!1}),2e3);const $progressBar=$dialog.find(".dialog-progress-bar");try{dialogBody=await jQuery.ajax({url:options.source,xhr:()=>{$progressBar.css("width","40%");const xhr=new window.XMLHttpRequest;return xhr.addEventListener("progress",(evt=>{if(evt.lengthComputable){const loadProgress=evt.loaded/evt.total;$progressBar.css("width",100*loadProgress+"%")}}),!1),xhr}}),options.fragment&&(dialogBody=jQuery(dialogBody).find(options.fragment).html()),dialogBody.includes("<head")&&(dialogBody=`<iframe src="${options.source}"></iframe>`,$dialog.addClass("has-iframe"),console.warn('package @aamasri/dialog recommends using the "iframe" or "fragment" options when the loading a full HTML document!'))}catch(error){dialogBody=error.responseText?error.responseText:error.statusText?`Loading url ${options.source} failed with "${error.statusText}"`:"Loading url ${options.source} failed!"}false,loadUrlBusy=!1,$dialog.find(".dialog-body").html(dialogBody),openAnimation.pause(),openAnimation=openAnimateDialog($dialog)}return await openAnimation.finished,$dialog.find(".dialog-header .icons svg").fadeIn(),$dialog.removeClass("loading"),$dialog[0]};function openAnimateDialog($dialog){const $window=jQuery(window),dialogWidth=$dialog.width(),dialogArea=$dialog.height()*dialogWidth,windowWidth=$window.width(),windowArea=$window.height()*windowWidth,large=dialogArea/windowArea>.3;large&&$dialog.addClass("large");const formInput=document.querySelector(`#${$dialog[0].id} .dialog-body input`);formInput&&(formInput.focus(),formInput.select());const wide=dialogWidth/windowWidth>.8,easing=wide||large?"cubicBezier(0.190, 1.000, 0.400, 1.000)":"easeOutElastic(1, 0.6)";const animeConfig={targets:$dialog[0],translateX:["-50%","-50%"],translateY:["-50%","-50%"],scale:[0,1],duration:500,easing:easing};return $dialog[0].style.visibility="visible",anime(animeConfig)}const closeAll=function(exceptId){const dialogs=getAllDialogs(exceptId),modals=function(exceptId){return document.querySelectorAll(".dialog-modal"+(exceptId?':not([data-for="'+exceptId+'"])':""))}(exceptId);dialogs.length&&dialogs.forEach((dialog=>{dialog.remove()})),modals.length&&modals.forEach((modal=>{modal.remove()})),destroyDialogListeners()},closeLast=function(){const dialogs=getAllDialogs();if(dialogs.length){const lastDialog=dialogs[dialogs.length-1];lastDialog.classList.contains("persistent")||dialog_close(lastDialog)}},dialog_close=function(dialog){if("string"==typeof dialog?dialog=document.querySelector(dialog):dialog instanceof jQuery&&(dialog=dialog[0]),null===dialog||!dialog instanceof Element)return;if(null===(dialog=dialog.closest(".dialog-box")))return;if(dialog.classList.contains("loading"))return void dialog.classList.add("remove-after-loaded");dialog.classList.add("closing");anime({targets:dialog,translateX:[{value:["-50%","-50%"]}],translateY:[{value:["-50%","-50%"]}],scale:[{value:[1,0]}],opacity:[{value:[1,0]}],duration:300,easing:"linear"}).finished.then((()=>{const relatedModal=function(dialog){return document.querySelector(`.dialog-modal[data-for="${dialog.id}"]`)}(dialog);relatedModal&&relatedModal.remove(),dialog.remove(),destroyDialogListeners()}))};function getAllDialogs(exceptId){return document.querySelectorAll(".dialog-box"+(exceptId?`:not(#${exceptId})`:""))}let blurHandlerBound=!1;function destroyDialogListeners(){blurHandlerBound&&!getAllDialogs().length&&(jQuery(document).off("click",docClickHandler),jQuery(document).off("keydown",docKeyHandler),blurHandlerBound=!1)}function docKeyHandler(event){"Escape"===event.key&&(document.activeElement&&"BODY"!==document.activeElement.nodeName?document.activeElement.blur():closeLast())}function docClickHandler(event){if(throttleEvent())return;const clicked=event.target;if(!clicked.parentNode)return;const closestDialogBox=clicked.closest(".dialog-box");if(closestDialogBox){false;const createdAt=closestDialogBox.getAttribute("data-created");if(getAllDialogs().forEach((dialog=>{dialog.getAttribute("data-created")>createdAt&&dialog_close(dialog)})),clicked.closest(".icon-close")&&dialog_close(closestDialogBox),clicked.closest(".icon-fullscreen")){const url=closestDialogBox.getAttribute("data-url");false,window.open(url,"_self")}return}const closestModalOverlay=clicked.closest(".dialog-modal");if(closestModalOverlay){const relatedDialog=function(modal){const dialogId=modal.getAttribute("data-for");return document.getElementById(dialogId)}(closestModalOverlay);if(relatedDialog){false;const createdAt=relatedDialog.getAttribute("data-created");getAllDialogs().forEach((dialog=>{dialog.getAttribute("data-created")>=createdAt&&(dialog.classList.contains("persistent")||dialog_close(dialog))}))}else false}else closeLast()}let eventTimestamp=0;function throttleEvent(){const now=Date.now();return eventTimestamp+500>now||(eventTimestamp=now,!1)}const usageInstructions='Usage instructions for developers: \n<pre style="color:#888; font-size: 12px;">\noptions object {\n    title:      string              dialog title or source element title attribute\n    source:     string | object     the content source: html content, selector, url, or element\n    fragment:   selector            selector by which to isolate a portion of the source HTML\n    modal:      boolean             page background dimming\n    iframe:     boolean             if the source is a url, whether to load it in an iFrame\n    replace:    boolean             whether to close any existing dialogs or layer up\n    persistent: boolean             whether ESC/blur automatically closes the dialog\n    onClose:    function | string   callback function or eval(string) to execute after dialog dismissed\n    classes:    string              classes to apply to the dialog container element\n    attributes: string              attributes to apply to the dialog container element eg. \'data-ignore-events="true"\'\n}\n</pre>\n\n<pre style="color: royalblue;  font-size: 12px;">\ndialog.open(options).then(function() {\n    console.log(\'dialog launched\');\n});\n</pre>'}}]);
//# sourceMappingURL=chunk_dialog.js.map